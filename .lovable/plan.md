

# תכנית: הוספת שלבי פרויקט להתחדשות עירונית

## הבעיה
הבקשה היא להוסיף שלבים נוספים ספציפית לפרויקטי התחדשות עירונית (תמ"א 38/1, תמ"א 38/2, פינוי מתחמים).

## המצב הנוכחי

רשימת השלבים הנוכחית ב-`PROJECT_PHASES`:

```
1.  בדיקה ראשונית
2.  תכנון ראשוני
3.  עמידה בתנאי סף
4.  פרסום
5.  בקרה מרחבית
6.  דיון בוועדה
7.  מכון בקרה
8.  אישור תחילת עבודות
9.  התקבל היתר
10. ביצוע
11. הסתיים
```

## השינויים המבוקשים

| מיקום | שלב חדש | הערות |
|-------|---------|-------|
| אחרי "בדיקה ראשונית" | **הגשת הצעה** | שלב חדש |
| אחרי "תכנון ראשוני" | **בחתימות** | שלב חדש |
| אחרי "מכון בקרה" | **בקבלת היתר** | שלב חדש |
| אחרי "בקבלת היתר" | **באישור תחילת עבודות** | שינוי נוסח? |

**הערה:** קיימים כבר "אישור תחילת עבודות" ו-"התקבל היתר" - הבקשה כוללת סדר הפוך ונוסח שונה ("בקבלת היתר" / "באישור תחילת עבודות").

## הפתרון המומלץ

### אפשרות נבחרת: שלבים גלובליים מעודכנים

מכיוון שהרשימה הנוכחית היא גלובלית לכל סוגי הפרויקטים, נעדכן את `PROJECT_PHASES` כך:

```typescript
export const PROJECT_PHASES = [
  'בדיקה ראשונית',
  'הגשת הצעה',           // חדש
  'תכנון ראשוני',
  'בחתימות',             // חדש
  'עמידה בתנאי סף',
  'פרסום',
  'בקרה מרחבית',
  'דיון בוועדה',
  'מכון בקרה',
  'בקבלת היתר',          // חדש (מחליף "התקבל היתר")
  'באישור תחילת עבודות', // חדש (מחליף "אישור תחילת עבודות")
  'ביצוע',
  'הסתיים'
] as const;
```

---

## שלבים לביצוע

| # | קובץ | שינוי |
|---|------|-------|
| 1 | `src/constants/project.ts` | עדכון `PROJECT_PHASES` עם השלבים החדשים והסדר הנכון |

---

## פרטים טכניים

### שינוי בקובץ `src/constants/project.ts` (שורות 106-118)

**לפני:**
```typescript
export const PROJECT_PHASES = [
  'בדיקה ראשונית',
  'תכנון ראשוני',
  'עמידה בתנאי סף',
  'פרסום',
  'בקרה מרחבית',
  'דיון בוועדה',
  'מכון בקרה',
  'אישור תחילת עבודות',
  'התקבל היתר',
  'ביצוע',
  'הסתיים'
] as const;
```

**אחרי:**
```typescript
export const PROJECT_PHASES = [
  'בדיקה ראשונית',
  'הגשת הצעה',              // חדש - אחרי בדיקה ראשונית
  'תכנון ראשוני',
  'בחתימות',                // חדש - אחרי תכנון ראשוני
  'עמידה בתנאי סף',
  'פרסום',
  'בקרה מרחבית',
  'דיון בוועדה',
  'מכון בקרה',
  'בקבלת היתר',             // חדש - אחרי מכון בקרה
  'באישור תחילת עבודות',    // נוסח מעודכן
  'ביצוע',
  'הסתיים'
] as const;
```

---

## השפעה על נתונים קיימים

פרויקטים קיימים שיש להם שלבים ישנים (כמו "התקבל היתר" או "אישור תחילת עבודות") יציגו את הערך כפי שהוא שמור בדאטאבייס, אך לא יהיו בדרופדאון. ייתכן שיידרש migration לעדכון נתונים קיימים:

```sql
-- אופציונלי: עדכון ערכים קיימים
UPDATE projects SET phase = 'בקבלת היתר' WHERE phase = 'התקבל היתר';
UPDATE projects SET phase = 'באישור תחילת עבודות' WHERE phase = 'אישור תחילת עבודות';
```

